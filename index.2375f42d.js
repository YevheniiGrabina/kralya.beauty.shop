document.addEventListener("DOMContentLoaded",(function(){var t=document.querySelectorAll(".product__btn"),e=document.querySelector(".cart-content__list"),r=document.querySelector(".cart"),c=r.querySelector(".cart__quantity"),o=document.querySelector(".fullprice"),n=document.querySelector(".order-modal__btn"),a=document.querySelector(".order-modal__list"),l=0,d=0,u=[],i=function(t){return t.replace(/\s/g,"")},s=function(t){return String(t).replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,"грн")},p=function(){var t=e.querySelector(".simplebar-content").children.length;c.textContent=t,t>0?r.classList.add("active"):r.classList.remove("active")},_=function(){o.textContent="".concat(s(l)," грн")},m=function(t){var e=t.querySelector(".cart-product").dataset.id;document.querySelector('.product[data-id="'.concat(e,'"]')).querySelector(".product__btn").disabled=!1,function(t){l-=t}(parseInt(i(t.querySelector(".cart-product__price").textContent))),_(),t.remove(),p(),q()};t.forEach((function(t){t.closest(".product").setAttribute("data-id",d++),t.addEventListener("click",(function(t){var r=t.currentTarget,c=r.closest(".product"),o=c.dataset.id,n=c.querySelector(".image-switch__img img").getAttribute("src"),a=c.querySelector(".product__title").textContent,d=i(c.querySelector(".product-price__current").textContent),u=parseInt(i(c.querySelector(".product-price__current").textContent));l+=u,_(),e.querySelector(".simplebar-content").insertAdjacentHTML("afterbegin",function(t,e,r,c){return'\n\t\t\t<li class="cart-content__item">\n\t\t\t\t<article class="cart-content__product cart-product" data-id="'.concat(c,'">\n\t\t\t\t\t<img src="').concat(t,'" alt="" class="cart-product__img">\n\t\t\t\t\t<div class="cart-product__text">\n\t\t\t\t\t\t<h3 class="cart-product__title">').concat(e,'</h3>\n\t\t\t\t\t\t<span class="cart-product__price">').concat(s(r),'</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button class="cart-product__delete" aria-label="Удалить товар"></button>\n\t\t\t\t</article>\n\t\t\t</li>\n\t\t')}(n,a,d,o)),p(),q(),r.disabled=!0}))})),e.addEventListener("click",(function(t){t.target.classList.contains("cart-product__delete")&&m(t.target.closest(".cart-content__item"))}));var y=0;n.addEventListener("click",(function(t){0==y?(n.classList.add("open"),a.style.display="block",y=1):(n.classList.remove("open"),a.style.display="none",y=0)}));var S=function(t,e,r,c){return'\n\t\t\t<li class="order-modal__item">\n\t\t\t\t<article class="order-modal__product order-product" data-id="'.concat(c,'">\n\t\t\t\t\t<img src="').concat(t,'" alt="" class="order-product__img">\n\t\t\t\t\t<div class="order-product__text">\n\t\t\t\t\t\t<h3 class="order-product__title">').concat(e,'</h3>\n\t\t\t\t\t\t<span class="order-product__price">').concat(s(r),'</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button class="order-product__delete">Удалить</button>\n\t\t\t\t</article>\n\t\t\t</li>\n\t\t')};new GraphModal({isOpen:function(t){console.log("opened");var r=e.querySelector(".simplebar-content").children,c=o.textContent,n=r.length;document.querySelector(".order-modal__quantity span").textContent="".concat(n," шт"),document.querySelector(".order-modal__summ span").textContent="".concat(c);var l=!0,d=!1,s=void 0;try{for(var p,_=r[Symbol.iterator]();!(l=(p=_.next()).done);l=!0){item=p.value,console.log(item);var m=item.querySelector(".cart-product__img").getAttribute("src"),y=item.querySelector(".cart-product__title").textContent,q=i(item.querySelector(".cart-product__price").textContent),v=item.querySelector(".cart-product").dataset.id;a.insertAdjacentHTML("afterbegin",S(m,y,q,v));var g={};g.title=y,g.price=q,u.push(g)}}catch(t){d=!0,s=t}finally{try{l||null==_.return||_.return()}finally{if(d)throw s}}console.log(u)},isClose:function(){console.log("closed")}});document.querySelector(".order").addEventListener("submit",(function(t){t.preventDefault();var e=t.currentTarget,r=new FormData(e),c=e.querySelector('[name="Имя"]').value,o=e.querySelector('[name="Телефон"]').value,n=e.querySelector('[name="Email"]').value;r.append("Товары",JSON.stringify(u)),r.append("Имя",c),r.append("Телефон",o),r.append("Email",n);var a=new XMLHttpRequest;a.onreadystatechange=function(){4===a.readyState&&200===a.status&&console.log("Отправлено")},a.open("POST","mail.php",!0),a.send(r),e.reset()}));null!==localStorage.getItem("products")&&(e.querySelector(".simplebar-content").innerHTML=localStorage.getItem("products"),p(),document.querySelectorAll(".cart-content__item").forEach((function(t){l+=parseInt(i(t.querySelector(".cart-product__price").textContent))})),_(),document.querySelectorAll(".cart-content__product").forEach((function(t){var e=t.dataset.id;console.log(e),document.querySelector('.product[data-id="'.concat(e,'"]')).querySelector(".product__btn").disabled=!0})));var q=function(){var t=e.querySelector(".simplebar-content").innerHTML;(t=t.trim()).length?localStorage.setItem("products",t):localStorage.removeItem("products")};document.querySelector(".modal").addEventListener("click",(function(t){if(t.target.classList.contains("order-product__delete")){var e=t.target.closest(".order-modal__product").dataset.id,r=document.querySelector('.cart-content__product[data-id="'.concat(e,'"]')).closest(".cart-content__item");m(r),t.target.closest(".order-modal__product").remove()}}))}));
//# sourceMappingURL=index.2375f42d.js.map
